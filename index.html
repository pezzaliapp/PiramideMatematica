<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>La Piramide Matematica 3D — 5×5→1</title>

  <!-- Font stile KubeApp -->
  <link href="https://fonts.googleapis.com/css2?family=Bungee:wght@400&family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <meta name="theme-color" content="#0b5fff">

  <style>
    :root{
      --brand:#0b5fff; --ink:#ffffff; --bg:#0c0f14; --dup:#ff3b30;
      --cube:#ffffff;  --edge:#000000;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .bar{
      position:sticky;top:0;z-index:5;display:flex;gap:10px;align-items:center;flex-wrap:wrap;
      padding:10px 14px;background:var(--brand);color:#fff;box-shadow:0 8px 24px rgba(0,0,0,.06)
    }
    .title{font-family:Bungee,Inter,system-ui,sans-serif;font-size:18px;font-weight:800;letter-spacing:.3px;margin-right:auto}
    .row{display:flex;gap:9px;align-items:center;flex-wrap:wrap}
    .chip{width:34px;height:34px;display:inline-flex;align-items:center;justify-content:center;
      border:2px solid #fff;background:#fff;color:#111;font-weight:800;border-radius:999px;cursor:pointer;user-select:none;
      box-shadow:0 0 1px rgba(0,0,0,.2) inset}
    .chip.active{outline:2px solid rgba(0,0,0,.25)}
    .btn,.icon-btn{border:0;border-radius:10px;padding:8px 12px;background:#fff;color:#111;font-weight:800;cursor:pointer}
    .icon-btn{display:inline-flex;align-items:center;justify-content:center;width:38px;height:38px}
    .status{font-weight:800;opacity:.9}
    #stage{height:calc(100vh - 94px);touch-action:none}

    /* Badge frontale stile Kube */
    .badge{
      position:absolute;left:14px;top:56px;padding:6px 10px;font-size:12px;font-weight:700;
      background:#111;color:#fff;border-radius:999px;box-shadow:0 10px 26px rgba(0,0,0,.25);pointer-events:none
    }

    /* Settings dialog */
    dialog.settings{border:0;border-radius:16px;padding:18px 18px 12px;width:min(520px,92vw)}
    dialog::backdrop{background:rgba(0,0,0,.4)}
    .settings h2{margin:0 0 10px;font-family:Bungee,Inter,sans-serif}
    .settings fieldset{border:1px solid #ddd;border-radius:12px;padding:12px;margin:10px 0}
    .settings legend{font-weight:700}
    .settings .grid{display:grid;grid-template-columns:auto 1fr;gap:10px 12px;align-items:center}
    .settings menu{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}

    @media (max-width:600px){#stage{height:calc(100vh - 150px)}}
  </style>
</head>
<body>
  <div class="bar">
    <div class="title">LA PIRAMIDE MATEMATICA</div>

    <div id="palette" class="row" aria-label="Scegli un numero da 1 a 15"></div>

    <button class="btn" id="btn-shuffle">Mescola 5</button>
    <button class="btn" id="btn-reset">Reset</button>

    <div class="status" id="status">Differenze uniche: <b>0/10</b></div>

    <button class="icon-btn" id="btn-settings" title="Impostazioni" aria-label="Impostazioni">
      <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
        <path fill="currentColor"
          d="M12 8a4 4 0 100 8 4 4 0 000-8zm9.4 4a7.5 7.5 0 00-.1-1l2-1.6-2-3.5-2.4 1a7.5 7.5 0 00-1.7-1l-.4-2.6H9.2l-.4 2.6a7.5 7.5 0 00-1.7 1l-2.4-1-2 3.5 2 1.6a7.5 7.5 0 000 2l-2 1.6 2 3.5 2.4-1a7.5 7.5 0 001.7 1l.4 2.6h5.8l.4-2.6a7.5 7.5 0 001.7-1l2.4 1 2-3.5-2-1.6c.1-.3.1-.7.1-1z"/>
      </svg>
    </button>
  </div>

  <div class="badge">LA PIRAMIDE MATEMATICA</div>
  <div id="stage" aria-label="Piramide di cubi 3D"></div>

  <!-- Pannello Impostazioni -->
  <dialog id="settings" class="settings">
    <form method="dialog">
      <h2>Impostazioni</h2>
      <fieldset>
        <legend>Tema</legend>
        <div class="grid">
          <label>Barra</label>        <input type="color" id="c-bar" value="#0b5fff">
          <label>Sfondo</label>       <input type="color" id="c-bg"  value="#0c0f14">
          <label>Inchiostro</label>   <input type="color" id="c-ink" value="#ffffff">
          <label>Colore cubi</label>  <input type="color" id="c-cube" value="#ffffff">
          <label>Bordo cubi</label>   <input type="color" id="c-edge" value="#000000">
          <label>Errore</label>       <input type="color" id="c-dup" value="#ff3b30">
        </div>
        <div class="row" style="margin-top:10px">
          <button class="btn" id="btn-theme-kube" type="button">KubeApp</button>
          <button class="btn" id="btn-theme-dark" type="button">Dark</button>
          <button class="btn" id="btn-theme-light" type="button">Light</button>
        </div>
      </fieldset>
      <menu>
        <button class="btn" value="cancel">Chiudi</button>
        <button class="btn" id="btn-save-theme" value="default">Salva</button>
        <button class="btn" id="btn-reset-theme" type="button">Ripristina</button>
      </menu>
    </form>
  </dialog>

  <script src="three.js"></script>
  <script src="pyramid.js"></script>
</body>
</html>
